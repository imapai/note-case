<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.49">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>Hadoop学习笔记 | 未销的笔记</title><meta name="description" content="学习笔记在线站点">
    <link rel="modulepreload" href="/note-case/assets/app.fdaa301a.js"><link rel="modulepreload" href="/note-case/assets/Hadoop基础笔记.html.63201c82.js"><link rel="modulepreload" href="/note-case/assets/Hadoop基础笔记.html.3dc8321b.js"><link rel="prefetch" href="/note-case/assets/index.html.926a91b2.js"><link rel="prefetch" href="/note-case/assets/Go命名规范.html.22d64aca.js"><link rel="prefetch" href="/note-case/assets/Go语言之优雅的Switch语句.html.dae476ba.js"><link rel="prefetch" href="/note-case/assets/Go语言基础语法.html.c9203735.js"><link rel="prefetch" href="/note-case/assets/index.html.fc8cf091.js"><link rel="prefetch" href="/note-case/assets/ApacheHttpd文件服务.html.6b47d7ca.js"><link rel="prefetch" href="/note-case/assets/Linux的Mysql使用rpm安装采坑指南.html.8d1d59fc.js"><link rel="prefetch" href="/note-case/assets/Minio自建OSS对象存储.html.687dc77f.js"><link rel="prefetch" href="/note-case/assets/index.html.3858b987.js"><link rel="prefetch" href="/note-case/assets/jenkins.html.4211276c.js"><link rel="prefetch" href="/note-case/assets/index.html.2c3a965f.js"><link rel="prefetch" href="/note-case/assets/kubernetes.html.e9e7688c.js"><link rel="prefetch" href="/note-case/assets/尚硅谷学习笔记.html.c6607715.js"><link rel="prefetch" href="/note-case/assets/Gitbook写文档.html.85e7a881.js"><link rel="prefetch" href="/note-case/assets/Gitbook替代者docsify.html.88a25dae.js"><link rel="prefetch" href="/note-case/assets/Git常用命令.html.32050e3a.js"><link rel="prefetch" href="/note-case/assets/Git配置多个远程仓库.html.b9846a8d.js"><link rel="prefetch" href="/note-case/assets/IDEA的dockers插件使用.html.7706e06f.js"><link rel="prefetch" href="/note-case/assets/Node终极版本管理方案NVM.html.a6f6ac68.js"><link rel="prefetch" href="/note-case/assets/Nrm-npm镜像源管理.html.3ba4fa69.js"><link rel="prefetch" href="/note-case/assets/Oh-My-Zsh.html.9ca0fb00.js"><link rel="prefetch" href="/note-case/assets/index.html.79b88385.js"><link rel="prefetch" href="/note-case/assets/brew 常用命令.html.eb3fa7f5.js"><link rel="prefetch" href="/note-case/assets/docker4springboot.html.032b41fc.js"><link rel="prefetch" href="/note-case/assets/docker基础.html.6f026b8a.js"><link rel="prefetch" href="/note-case/assets/自制SpringBootStarter.html.5e8aa5ca.js"><link rel="prefetch" href="/note-case/assets/SpringGateway.html.a2ce2161.js"><link rel="prefetch" href="/note-case/assets/index.html.f4178e91.js"><link rel="prefetch" href="/note-case/assets/index.html.9acf94d8.js"><link rel="prefetch" href="/note-case/assets/404.html.7d858b3d.js"><link rel="prefetch" href="/note-case/assets/index.html.cd804a1b.js"><link rel="prefetch" href="/note-case/assets/Go命名规范.html.468265ca.js"><link rel="prefetch" href="/note-case/assets/Go语言之优雅的Switch语句.html.651afd94.js"><link rel="prefetch" href="/note-case/assets/Go语言基础语法.html.1e520014.js"><link rel="prefetch" href="/note-case/assets/index.html.a9ae2830.js"><link rel="prefetch" href="/note-case/assets/ApacheHttpd文件服务.html.1c1624a1.js"><link rel="prefetch" href="/note-case/assets/Linux的Mysql使用rpm安装采坑指南.html.52293974.js"><link rel="prefetch" href="/note-case/assets/Minio自建OSS对象存储.html.4df85810.js"><link rel="prefetch" href="/note-case/assets/index.html.65b20d2f.js"><link rel="prefetch" href="/note-case/assets/jenkins.html.422a19d0.js"><link rel="prefetch" href="/note-case/assets/index.html.856b9dee.js"><link rel="prefetch" href="/note-case/assets/kubernetes.html.caa2fd5f.js"><link rel="prefetch" href="/note-case/assets/尚硅谷学习笔记.html.31158c01.js"><link rel="prefetch" href="/note-case/assets/Gitbook写文档.html.1fb6e8bf.js"><link rel="prefetch" href="/note-case/assets/Gitbook替代者docsify.html.3f4754e4.js"><link rel="prefetch" href="/note-case/assets/Git常用命令.html.ee246434.js"><link rel="prefetch" href="/note-case/assets/Git配置多个远程仓库.html.7bbbbcf2.js"><link rel="prefetch" href="/note-case/assets/IDEA的dockers插件使用.html.c8e294e7.js"><link rel="prefetch" href="/note-case/assets/Node终极版本管理方案NVM.html.db3d59dc.js"><link rel="prefetch" href="/note-case/assets/Nrm-npm镜像源管理.html.94f3ce9d.js"><link rel="prefetch" href="/note-case/assets/Oh-My-Zsh.html.2bb455ff.js"><link rel="prefetch" href="/note-case/assets/index.html.52afe28d.js"><link rel="prefetch" href="/note-case/assets/brew 常用命令.html.507f63fc.js"><link rel="prefetch" href="/note-case/assets/docker4springboot.html.1d7de79c.js"><link rel="prefetch" href="/note-case/assets/docker基础.html.3a6f4897.js"><link rel="prefetch" href="/note-case/assets/自制SpringBootStarter.html.0af861e4.js"><link rel="prefetch" href="/note-case/assets/SpringGateway.html.34a91365.js"><link rel="prefetch" href="/note-case/assets/index.html.c4da1e3d.js"><link rel="prefetch" href="/note-case/assets/index.html.97023c9c.js"><link rel="prefetch" href="/note-case/assets/404.html.66ff09c2.js"><link rel="prefetch" href="/note-case/assets/404.a523d740.js"><link rel="prefetch" href="/note-case/assets/Layout.6e06d58f.js">
    <link rel="stylesheet" href="/note-case/assets/style.9443ef8d.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/note-case/" class=""><img class="logo" src="/note-case/images/logo.JPG" alt="未销的笔记"><span class="site-name can-hide">未销的笔记</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Go 语言"><span class="title">Go 语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Go 语言"><span class="title">Go 语言</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><a href="/note-case/go/README.md" class="" aria-label="Go 语言基础"><!--[--><!--]--> Go 语言基础 <!--[--><!--]--></a></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/note-case/go/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95.html" class="" aria-label="Go语言基础语法"><!--[--><!--]--> Go语言基础语法 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/note-case/go/Go%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83.html" class="" aria-label="Go语言代码规范"><!--[--><!--]--> Go语言代码规范 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Go 语言进阶</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/note-case/go/Go%E8%AF%AD%E8%A8%80%E4%B9%8B%E4%BC%98%E9%9B%85%E7%9A%84Switch%E8%AF%AD%E5%8F%A5.html" class="" aria-label="Go语言之优雅的Switch语句"><!--[--><!--]--> Go语言之优雅的Switch语句 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="安装笔记"><span class="title">安装笔记</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="安装笔记"><span class="title">安装笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/note-case/install/ApacheHttpd%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1.html" class="" aria-label="HTTPD简易搭建文件上传下载"><!--[--><!--]--> HTTPD简易搭建文件上传下载 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/install/jenkins.html" class="" aria-label="Jenkins"><!--[--><!--]--> Jenkins <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/install/Linux%E7%9A%84Mysql%E4%BD%BF%E7%94%A8rpm%E5%AE%89%E8%A3%85%E9%87%87%E5%9D%91%E6%8C%87%E5%8D%97.html" class="" aria-label="MySql安装踩坑指南"><!--[--><!--]--> MySql安装踩坑指南 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/install/Minio%E8%87%AA%E5%BB%BAOSS%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8.html" class="" aria-label="Minio"><!--[--><!--]--> Minio <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="使用指南"><span class="title">使用指南</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="使用指南"><span class="title">使用指南</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/note-case/other/Gitbook%E5%86%99%E6%96%87%E6%A1%A3.html" class="" aria-label="Gitbook使用"><!--[--><!--]--> Gitbook使用 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Gitbook%E6%9B%BF%E4%BB%A3%E8%80%85docsify.html" class="" aria-label="Gitbook替代者docsify"><!--[--><!--]--> Gitbook替代者docsify <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html" class="" aria-label="Git常用命令"><!--[--><!--]--> Git常用命令 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Git%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93.html" class="" aria-label="Git配置多个远程仓库"><!--[--><!--]--> Git配置多个远程仓库 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/IDEA%E7%9A%84dockers%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8.html" class="" aria-label="IDEA插件之Docker"><!--[--><!--]--> IDEA插件之Docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Node%E7%BB%88%E6%9E%81%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E6%96%B9%E6%A1%88NVM.html" class="" aria-label="Nodejs版本管理工具Nvm"><!--[--><!--]--> Nodejs版本管理工具Nvm <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Nrm-npm%E9%95%9C%E5%83%8F%E6%BA%90%E7%AE%A1%E7%90%86.html" class="" aria-label="Npm镜像源管理"><!--[--><!--]--> Npm镜像源管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Oh-My-Zsh.html" class="" aria-label="Oh-My-Zsh"><!--[--><!--]--> Oh-My-Zsh <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/docker4springboot.html" class="" aria-label="制作一个简单的 docker 镜像"><!--[--><!--]--> 制作一个简单的 docker 镜像 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/docker%E5%9F%BA%E7%A1%80.html" class="" aria-label="Docker基础"><!--[--><!--]--> Docker基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/brew%20%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html" class="" aria-label="Homebrew 常用命令"><!--[--><!--]--> Homebrew 常用命令 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Go 语言"><span class="title">Go 语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Go 语言"><span class="title">Go 语言</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><a href="/note-case/go/README.md" class="" aria-label="Go 语言基础"><!--[--><!--]--> Go 语言基础 <!--[--><!--]--></a></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/note-case/go/Go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95.html" class="" aria-label="Go语言基础语法"><!--[--><!--]--> Go语言基础语法 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/note-case/go/Go%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83.html" class="" aria-label="Go语言代码规范"><!--[--><!--]--> Go语言代码规范 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Go 语言进阶</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/note-case/go/Go%E8%AF%AD%E8%A8%80%E4%B9%8B%E4%BC%98%E9%9B%85%E7%9A%84Switch%E8%AF%AD%E5%8F%A5.html" class="" aria-label="Go语言之优雅的Switch语句"><!--[--><!--]--> Go语言之优雅的Switch语句 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="安装笔记"><span class="title">安装笔记</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="安装笔记"><span class="title">安装笔记</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/note-case/install/ApacheHttpd%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1.html" class="" aria-label="HTTPD简易搭建文件上传下载"><!--[--><!--]--> HTTPD简易搭建文件上传下载 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/install/jenkins.html" class="" aria-label="Jenkins"><!--[--><!--]--> Jenkins <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/install/Linux%E7%9A%84Mysql%E4%BD%BF%E7%94%A8rpm%E5%AE%89%E8%A3%85%E9%87%87%E5%9D%91%E6%8C%87%E5%8D%97.html" class="" aria-label="MySql安装踩坑指南"><!--[--><!--]--> MySql安装踩坑指南 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/install/Minio%E8%87%AA%E5%BB%BAOSS%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8.html" class="" aria-label="Minio"><!--[--><!--]--> Minio <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="使用指南"><span class="title">使用指南</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="使用指南"><span class="title">使用指南</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/note-case/other/Gitbook%E5%86%99%E6%96%87%E6%A1%A3.html" class="" aria-label="Gitbook使用"><!--[--><!--]--> Gitbook使用 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Gitbook%E6%9B%BF%E4%BB%A3%E8%80%85docsify.html" class="" aria-label="Gitbook替代者docsify"><!--[--><!--]--> Gitbook替代者docsify <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html" class="" aria-label="Git常用命令"><!--[--><!--]--> Git常用命令 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Git%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93.html" class="" aria-label="Git配置多个远程仓库"><!--[--><!--]--> Git配置多个远程仓库 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/IDEA%E7%9A%84dockers%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8.html" class="" aria-label="IDEA插件之Docker"><!--[--><!--]--> IDEA插件之Docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Node%E7%BB%88%E6%9E%81%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E6%96%B9%E6%A1%88NVM.html" class="" aria-label="Nodejs版本管理工具Nvm"><!--[--><!--]--> Nodejs版本管理工具Nvm <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Nrm-npm%E9%95%9C%E5%83%8F%E6%BA%90%E7%AE%A1%E7%90%86.html" class="" aria-label="Npm镜像源管理"><!--[--><!--]--> Npm镜像源管理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/Oh-My-Zsh.html" class="" aria-label="Oh-My-Zsh"><!--[--><!--]--> Oh-My-Zsh <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/docker4springboot.html" class="" aria-label="制作一个简单的 docker 镜像"><!--[--><!--]--> 制作一个简单的 docker 镜像 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/docker%E5%9F%BA%E7%A1%80.html" class="" aria-label="Docker基础"><!--[--><!--]--> Docker基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/note-case/other/brew%20%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html" class="" aria-label="Homebrew 常用命令"><!--[--><!--]--> Homebrew 常用命令 <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="hadoop学习笔记" tabindex="-1"><a class="header-anchor" href="#hadoop学习笔记" aria-hidden="true">#</a> Hadoop学习笔记</h1><h2 id="大数据启蒙" tabindex="-1"><a class="header-anchor" href="#大数据启蒙" aria-hidden="true">#</a> 大数据启蒙</h2><p><strong>分治思想</strong></p><p>question1：</p><p>有一万行数据（数字或者单词），找出某个元素，如何在O(4)的复杂度找出这个值</p><p>answer1：</p><p>一万行数据hashcode散列处理，模除2500，得到2500组数据，每组数据存储4个值，查找是只需要散列后模除，便可以找到该组数据，遍历4次就可以找到。</p><p>question2：</p><p>假设有一个1T的文件，物理条件单机，内存有限，中间有两行是重复的，找出重复的行？</p><p>由于IO读写的问题，不可能每次都查找是否存在，然后按照行读取，比对。磁盘平均读取速度是500M/s，读取一次需要耗时2048秒，大约30分钟，如果有n行数据，则时间就是30*n。</p><p>answer2：</p><blockquote><p>读取一行，散列处理，模除2000，相同值存储到一个小文件</p><p>相同的内容肯定在一个文件中</p><p>加载到内存比对数据</p></blockquote><p>question3：</p><p>假设有1T数据，全部是无序的数字，对内容做一个全排序？</p><p>answer3：</p><p>​ 第一种：每次读取一行，值做判断 if(1&gt;num&gt;100)，读取一遍后得到一个内部无序，外部有序的小文件，依次对小文件排序，追加内容，完成排序。</p><p>​ 第二种：归并排序，每次读取100个数据，对100个数据排序，读取一遍得到一个内部有序，外部无序的小文件，对文件进行归并排序。</p><p>question4：</p><p>如何在question2的要求下，追加一条要求，在一分钟之内完成？</p><p>answer4：</p><p>引出Hadoop的MapReduce</p><blockquote><p>必须要多个机器，2000台机器，每一台机器500M，一秒读取完成</p><p>每台机器hashcode后模除2000得到，2000份小文件</p><p>互相拉去1-2000文件到本地，分别计算比对，找出相同内容</p></blockquote><p>结论：</p><ul><li>分而治之</li><li>并行计算</li><li>计算向数据移动</li><li>数据本地化读取</li></ul><p>以上是大数据技术重点关心的内容。</p><h3 id="hdfs存储模型" tabindex="-1"><a class="header-anchor" href="#hdfs存储模型" aria-hidden="true">#</a> HDFS存储模型</h3><p>HDFS文件存储系统的一些特性，HDFS是大数据存储的基础。</p><ul><li>文件线性按字节切割成块（block），具有offset，id</li><li>文件与文件的block大小可以不一样</li><li>一个文件除了最后一个block，其他block大小一致</li><li>block块的大小依据硬件的IO特性调整</li><li>block被分散的存储在集群的节点中，具有location</li><li>block具有副本（replication），没有主从概念，副本不能出现在同一个节点上</li><li>副本是满足可靠性和性能的关键</li><li>文件上传可以指定block的大小和副本数，上传后只能修改副本数</li><li>一次写入，多次读取，不支持修改</li><li>支持追加数据</li></ul><h3 id="角色" tabindex="-1"><a class="header-anchor" href="#角色" aria-hidden="true">#</a> 角色</h3><h4 id="namenode" tabindex="-1"><a class="header-anchor" href="#namenode" aria-hidden="true">#</a> NameNode</h4><ul><li>完全基于内存存储文件的元数据、目录结构、文件block的映射</li><li>需要持久化方案保证数据可靠性</li><li>提供副本放置策略</li></ul><h4 id="datenode" tabindex="-1"><a class="header-anchor" href="#datenode" aria-hidden="true">#</a> DateNode</h4><ul><li>基于本地磁盘存储block（文件形式）</li><li>并保证block的校验和数据保证block的可靠性</li><li>与NameNode保持心跳，汇报block列表状态</li></ul><h3 id="hdfs中的secondarynamenode-snn" tabindex="-1"><a class="header-anchor" href="#hdfs中的secondarynamenode-snn" aria-hidden="true">#</a> HDFS中的SecondaryNameNode(SNN)</h3><ul><li>在非Ha模式下，SNN一般是独立的节点，周期性的完成NameNode的EditLog向FsImage合并，减少EditLog大小，减少NameNode启动时间</li><li>根据配置文件设置的时间间隔fs.checkpoint.period 默认3600秒</li><li>根据配置文件设置edits log大小 fs.checkpoint.size 规定edits文件最大值默认64MB</li><li>当满足一小时，则执行一次，或者EditLog达到64MB后执行一次</li></ul><h3 id="hdfs写流程" tabindex="-1"><a class="header-anchor" href="#hdfs写流程" aria-hidden="true">#</a> HDFS写流程</h3><ul><li>Client和NameNode连接创建文件元数据</li><li>NameNode判定元数据是否有效</li><li>NameNode触发副本房子策略，返回有序的DataNode列表</li><li>Client和DateNode建立Pipeline连接</li><li>Client将块切分成packet（64k），并使用chunk（512B）+chunksum（4B）填充</li><li>Client将packet放入发送队列dataqueue中，并向第一个DateNode发送</li><li>第一个DataNode收到packet后本地保存并发送第二个DataNode</li><li>第二个DataNode收到packet后本地保存并发送第三个DataNode</li><li>这一过程中，上游节点同时发送一个packet</li><li>HDFS使用这种传输方式，副本数对于Client是透明的</li><li>当block传输完成，DataNode各自向NameNode汇报，同时Client继续传输下一个block</li><li>所以，client的传输和block的汇报也是并行的</li></ul><h3 id="hdfs读流程" tabindex="-1"><a class="header-anchor" href="#hdfs读流程" aria-hidden="true">#</a> HDFS读流程</h3><ul><li><p>为了降低整体的带宽消耗和读取延时，HDFS会尽量让读取程序读取离它最近的副本</p></li><li><p>如果在读取程序的同一个机架上有一个副本，那么就读取该副本</p></li><li><p>如果一个HDFS集群跨越多个数据中心，那么客户端也将首先读取本地的数据中心的副本</p></li><li><p>语义：下载一个文件：</p><ul><li>Client和NameNode交互文件元数据获取fileBlockLocation</li><li>NameNode会按照距离策略排序返回</li><li>Client尝试下载block并校验数据完整性</li></ul></li><li><p>语义：下载一个文件其实就是获取文件的所有block元数据，那么子集获取某些block应该成立</p><ul><li>HDFS支持Client给出文件的offset自定义连接哪些block的DataNode，自定义获取数据</li><li>这个是支持计算层的分治、并行计算的核心</li></ul></li></ul><h2 id="伪分布式的搭建" tabindex="-1"><a class="header-anchor" href="#伪分布式的搭建" aria-hidden="true">#</a> 伪分布式的搭建</h2><p><a href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>基础设施</p><p>1、安装centos</p><p>2、配置vm虚拟网络，配置centos网络</p><p>3、添加主机映射</p><p>4、关闭防火墙&amp;selinux（时间不一致会触发系统自读）</p><p>5、设置host映射</p><p>6、时间同步</p><p>7、安装JDK</p><p>8、配置免密登录</p><h3 id="安装centos7" tabindex="-1"><a class="header-anchor" href="#安装centos7" aria-hidden="true">#</a> 安装CentOS7</h3><p>centos，基于centos7.x</p><p>直接在vmware中创建虚拟机，下一步就完成了。</p><h3 id="配置网络" tabindex="-1"><a class="header-anchor" href="#配置网络" aria-hidden="true">#</a> 配置网络</h3><blockquote><p>vi /etc/sysconfig/network-scripts/ifcfg-ens33</p><p>修改BOOTPROTO=static，ONBOOT=yes，并添加IPADDR、NETMASK、GATEWAY、DNS1参数</p></blockquote><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">TYPE</span><span class="token punctuation">=</span><span class="token value attr-value">Ethernet</span>
<span class="token key attr-name">PROXY_METHOD</span><span class="token punctuation">=</span><span class="token value attr-value">none</span>
<span class="token key attr-name">BROWSER_ONLY</span><span class="token punctuation">=</span><span class="token value attr-value">no</span>
<span class="token key attr-name">BOOTPROTO</span><span class="token punctuation">=</span><span class="token value attr-value">static</span>
<span class="token key attr-name">DEFROUTE</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span>
<span class="token key attr-name">IPV4_FAILURE_FATAL</span><span class="token punctuation">=</span><span class="token value attr-value">no</span>
<span class="token key attr-name">IPV6INIT</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span>
<span class="token key attr-name">IPV6_AUTOCONF</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span>
<span class="token key attr-name">IPV6_DEFROUTE</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span>
<span class="token key attr-name">IPV6_FAILURE_FATAL</span><span class="token punctuation">=</span><span class="token value attr-value">no</span>
<span class="token key attr-name">IPV6_ADDR_GEN_MODE</span><span class="token punctuation">=</span><span class="token value attr-value">stable-privacy</span>
<span class="token key attr-name">NAME</span><span class="token punctuation">=</span><span class="token value attr-value">ens33</span>
<span class="token key attr-name">UUID</span><span class="token punctuation">=</span><span class="token value attr-value">6cd00e5c-0cad-45ed-a6f6-e5965b6d7074</span>
<span class="token key attr-name">DEVICE</span><span class="token punctuation">=</span><span class="token value attr-value">ens33</span>
<span class="token key attr-name">ONBOOT</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span>
<span class="token key attr-name">IPADDR</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.17.211</span>
<span class="token key attr-name">NETMASK</span><span class="token punctuation">=</span><span class="token value attr-value">255.255.255.0</span>
<span class="token key attr-name">GATEWAY</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.17.2</span>
<span class="token key attr-name">DNS1</span><span class="token punctuation">=</span><span class="token value attr-value">8.8.8.8</span>
<span class="token key attr-name">DNS2</span><span class="token punctuation">=</span><span class="token value attr-value">114.114.114.114</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>重启网络服务，service network restart</li><li>查看ip地址，ip addr</li><li>测试ping www.baidu.com</li><li>xshell连接</li></ul><p>添加主机名称映射</p><blockquote><p>vi /etc/sysconfig/network</p><p>NETWORKING=yes HOSTNAME=node01</p><h2 id="centos7" tabindex="-1"><a class="header-anchor" href="#centos7" aria-hidden="true">#</a> centos7</h2><p>临时生效</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>[root@centos7 ~]# hostname 132
[root@centos7 ~]# hostname
132123
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>永久生效（不会立刻修改，需重启）</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>[root@centos7 ~]# hostnamectl set-hostname centos7
(或者修改完之后执行`exec bash`立即改变)，
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>vi /etc/hosts</p><p>添加</p><p><code>ip</code></p><p>192.168.17.211 node01</p><p>192.168.17.212 node02</p><p>192.168.17.213 node03</p><p>192.168.17.214 node04</p></blockquote><p>关闭selinux</p><blockquote><p>vi /etc/selinux/config</p><p>SELINUX=disabled</p></blockquote><h3 id="关闭防火墙" tabindex="-1"><a class="header-anchor" href="#关闭防火墙" aria-hidden="true">#</a> 关闭防火墙</h3><p>1）关闭防火墙</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>centos6
<span class="token comment"># 关闭防火墙</span>
<span class="token function">service</span> iptables stop
<span class="token comment"># 开机禁用</span>
<span class="token function">chkconfig</span> iptables off
<span class="token comment"># 关闭服务</span>
systemctl stop firewalld 
<span class="token comment">#开机禁用</span>
systemctl disable firewalld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>centos7遇到问题</p><blockquote><p>遇到关闭防火墙，报错：Failed to start firewalled.service: Unit not found.</p><p># 启用防火墙</p><p>systemctl enable firewalld.service</p><p>systemctl restart firewalld.service</p><p># 查看防火墙状态</p><p>firewall-cmd --state</p><p>firewall-cmd --list-all</p></blockquote><p>2)开放端口，比如开放3306端口firewalled防火墙</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#开放3306端口</span>
firewall-cmd --permanent --add-port<span class="token operator">=</span><span class="token number">3306</span>/tcp
<span class="token comment">#重启防火墙</span>
firewall-cmd --reload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="时间同步" tabindex="-1"><a class="header-anchor" href="#时间同步" aria-hidden="true">#</a> 时间同步</h3><blockquote><p>yum install ntp -y</p><p>vi /etc/ntp.conf</p><p>server ntp1.aliyun.com</p><p>service ntpd start</p><p>chkconfig ntpd on</p></blockquote><h3 id="配置免密" tabindex="-1"><a class="header-anchor" href="#配置免密" aria-hidden="true">#</a> 配置免密</h3><p>测试，是否可以连接自己</p><blockquote><p>ssh localhost</p><p>需要密码就未配置免密</p></blockquote><p>配置免密</p><blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>  $ ssh-keygen -t rsa -P <span class="token string">&#39;&#39;</span> -f ~/.ssh/id_rsa
  $ <span class="token function">cat</span> ~/.ssh/id_rsa.pub <span class="token operator">&gt;&gt;</span> ~/.ssh/authorized_keys
  $ <span class="token function">chmod</span> 0600 ~/.ssh/authorized_keys
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>如果 A 想要 免密登录到 B:</p><p>​ A: ssh-keygen -t rsa -P &#39;&#39; -f ~/.ssh/id_rsa</p><p>​ B: cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</p><p>结论：B包含了A的公钥，A就可以免密的登录到B</p><h3 id="安装jdk" tabindex="-1"><a class="header-anchor" href="#安装jdk" aria-hidden="true">#</a> 安装JDK</h3><p>上传JDK到，/usr/java，解压，tar -zxvf jdk...，删除jdk的压缩包</p><blockquote><p>做软链接映射，避免有些软件找不到JDK</p><p>ln -s /usr/java/jdk1.8.0_231/ latest</p><p>ln -s /usr/java/latest default</p></blockquote><p>vi /etc/profile</p><blockquote><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">export</span> <span class="token value attr-value">JAVA_HOME=/usr/java/default</span>
<span class="token key attr-name">export</span> <span class="token value attr-value">PATH=$PATH:$JAVA_HOME/bin</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="hadoop部署配置" tabindex="-1"><a class="header-anchor" href="#hadoop部署配置" aria-hidden="true">#</a> Hadoop部署配置</h3><p>伪分布式：（单一节点）</p><p>1.部署路径文件</p><p>规划路径：</p><ul><li>mkdir /opt/bigdata</li><li>tar -zxvf hadoop.xxx.gz</li><li>mv hadoop-2.7.3 /opt/bigdata/</li></ul><p>2.配置文件</p><ul><li>hadoop-env.sh，hadoop的运行环境</li><li>core-site.xml，Common组件的环境</li><li>hdfs-site.xml，HDFS组件的配置</li><li>slaves，配置所有DataNode的主机名</li></ul><p>配置Hadoop的环境变量，这样就可以在任意位置使用hadoop的脚本文件</p><blockquote><p>vi /etc/profile</p><p>追加，export HADOOP_HOME=/opt/bigdata/hadoop-2.7.3</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">export</span> <span class="token value attr-value">JAVA_HOME=/usr/java/default</span>
<span class="token key attr-name">export</span> <span class="token value attr-value">HADOOP_HOME=/opt/bigdata/hadoop-2.7.3</span>
<span class="token key attr-name">export</span> <span class="token value attr-value">PATH=$PATH:$JAVA_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>hadoop-env.sh，配置Hadoop角色</p><blockquote><p>vi hadoop-env.sh</p><p>修改JAVA_HOME为绝对路径，避免其他主机远程说使用ssh访问不到，因为是不加载/etc/profile，导致jdk缺失</p><p>export JAVA_HOME=/usr/java/default</p></blockquote><p>core-site.xml，给出NameNode角色在哪里启动</p><blockquote><p>vi core-site.xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://node01:9000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>hdfs-site.xml，配置hdfs副本的数量为1</p><blockquote><p>vi hdfs-site.xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.replication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>slaves，配置DataNode在哪一台主机启动</p><blockquote><p>vi slaves</p><p>node01</p></blockquote><p>添加配置</p><blockquote><p>vi hdfs-site.xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.name.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/var/bigdata/hadoop/local/dfs/name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.datanode.data.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/var/bigdata/hadoop/local/dfs/data<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.secondary.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node01:50090<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.checkpoint.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/var/bigdata/hadoop/local/dfs/secondary<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>NN：确定DFS名称节点应该将名称表(fsimage)存储在本地文件系统的何处。如果这是一个以逗号分隔的目录列表，那么为了避免冗余，将在所有目录中复制name表。</p><p>DN：确定DFS数据节点应在本地文件系统上的哪个位置存储其块。 如果这是逗号分隔的目录列表，则数据将存储在所有命名的目录中，通常在不同的设备上。 对于HDFS存储策略，应使用相应的存储类型（[SSD] / [DISK] / [ARCHIVE] / [RAM_DISK]）标记目录。 如果目录没有显式标记的存储类型，则默认存储类型为DISK。 如果本地文件系统权限允许，将创建不存在的目录。</p></blockquote><p>3.初始化&amp;启动</p><blockquote><p>hdfs namenode -format</p><p>初始化一个空的FsImage</p><p>VERSION</p><p>CID</p></blockquote><p>start-dfs.sh，第一次：datanode和secondary角色会初始化创建自己的数据目录，也会生成VERSION，其中CID三者相同，保证datanode和secondary与namenode同步。</p><p>4.简单使用</p><p>hdfs dfs -mkdir /bigdata</p><p>hdfs dfs -mkdir -p /user/root</p><p>hdfs dfs -put 上传</p><p>5.验证知识点</p><p>cd /var/bigdata/hadoop/local/dfs/name/current</p><p>​ 观察 editLog的id是不是在fsimage的后面</p><p>cd /var/bigdata/hadoop/local/dfs/secondary/current</p><p>​ SNN 只需要从NN拷贝最后时点的FSimage和增量的EditLog</p><p>hdfs dfs -put hadoop.xx.tar.gz</p><p>cd /var/bigdata/hadoop/local/dfs/data/current/BP-955638036-192.168.17.211-1585708220284/current/finalized/subdir0/subdir0</p><p>会看到文件存储的块的信息</p><p>for i in `seq 100000`;do echo &quot;hello hadoop $i&quot; &gt;&gt; data.txt ;done</p><p>hdfs dfs -D dfs.blocksize=1048576 -put data.txt</p><p>cd /var/bigdata/hadoop/local/dfs/data/current/BP-955638036-192.168.17.211-1585708220284/current/finalized/subdir0/subdir0</p><p>检查文件，block被切割后的文件</p><p>结论：块按照字节的大小切分，不考虑文件的内容</p><h2 id="完全分布式" tabindex="-1"><a class="header-anchor" href="#完全分布式" aria-hidden="true">#</a> 完全分布式：</h2><p>基础环境</p><p>部署配置</p><h3 id="基础环境" tabindex="-1"><a class="header-anchor" href="#基础环境" aria-hidden="true">#</a> 基础环境</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>1.角色在哪里启动
NameNode：core-site.xml  fs.defaultFS hdfs://node01:9000
DataNode: slaves node01
SNN: hdfs-site.xml dfs.namenode.secondary.http.address node01:50090
2.角色启动时的细节配置
dfs.namenode.name.dir
dfs.datanode.data.dir
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>host</th><th>NameNode</th><th>Secondary</th><th>DataNode</th></tr></thead><tbody><tr><td>node01</td><td>*</td><td></td><td></td></tr><tr><td>node02</td><td></td><td>*</td><td>*</td></tr><tr><td>node03</td><td></td><td></td><td>*</td></tr><tr><td>node04</td><td></td><td></td><td>*</td></tr></tbody></table><ul><li><p>每台机器配置化网络，配置 JDK，OK</p></li><li><p>其他几台机器输入 ssh localhost，激活创建/root/.ssh隐藏文件夹</p></li><li><p>在node01中，scp ./id_rsa.pub node02:/root/.ssh/node01.pub（其他几台同样分发）</p></li><li><p>在node02中，cat node01.pub &gt;&gt; authorized_keys</p></li></ul><p>具体操作：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>node02:
	<span class="token function">ssh</span> locahost
node03:
	<span class="token function">ssh</span> localhsot
node04:
	<span class="token function">ssh</span> localhost
node01:
	<span class="token builtin class-name">cd</span> ~/.ssh
	<span class="token function">scp</span> ./id_rsa.pub    node02:/root/.ssh/node01.pub
	<span class="token function">scp</span> ./id_rsa.pub    node03:/root/.ssh/node01.pub
	<span class="token function">scp</span> ./id_rsa.pub    node04:/root/.ssh/node01.pub
node02；
	<span class="token builtin class-name">cd</span> ~/.ssh
	<span class="token function">cat</span> node01.pub  <span class="token operator">&gt;&gt;</span> authorized_keys
node03；
	<span class="token builtin class-name">cd</span> ~/.ssh
	<span class="token function">cat</span> node01.pub  <span class="token operator">&gt;&gt;</span> authorized_keys
node04；
	<span class="token builtin class-name">cd</span> ~/.ssh
	<span class="token function">cat</span> node01.pub  <span class="token operator">&gt;&gt;</span> authorized_keys
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>测试node01是否可以免密登录到其他机器</p><h3 id="配置部署" tabindex="-1"><a class="header-anchor" href="#配置部署" aria-hidden="true">#</a> 配置部署</h3><p>修改前可以备份文件到本地hadoop-local，复制文件，cp -r hadoop/ haoop-local</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>node01:
	cd $HADOOP/etc/hadoop
	vi core-site.xml NN配置不需要修改
	vi hdfs-site.cml ,修改如下：
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.replication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.name.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/var/bigdata/hadoop/full/dfs/name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.datanode.data.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/var/bigdata/hadoop/full/dfs/data<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.secondary.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node02:50090<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.checkpoint.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/var/bigdata/hadoop/full/dfs/secondary<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

	vi 	slaves
		node02
		node03
		node04
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>分发Hadoop：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cd /opt
	scp -r ./bigdata/ node02:`pwd`
	scp -r ./bigdata/ node03:`pwd`
	scp -r ./bigdata/ node04:`pwd`
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>格式化启动</p><p>​ hdfs namenode -format</p><p>​ start-dfs.sh</p><p>HDFS解决Namenode问题</p><blockquote><ul><li>单点故障 <ul><li>高可用方案：HA</li><li>多个NameNode，主备切换</li></ul></li><li>压力过大，内存受限 <ul><li>联邦机制：Federation（元数据分片）</li><li>多个NN，管理不同的元数据</li></ul></li><li>Hadoop 2.x只支持HA的一主一备</li></ul></blockquote><p>HDFS—HA解决方案</p><blockquote><p>CAP原则</p><p>Consistency：一致性</p><p>AVailability：可用性</p><p>Partition tolerence：分区容忍性</p></blockquote><h2 id="引入zookeeper" tabindex="-1"><a class="header-anchor" href="#引入zookeeper" aria-hidden="true">#</a> 引入Zookeeper</h2><ul><li>基础环境 <ul><li>增加NNs的ssh免密</li></ul></li><li>应用搭建 <ul><li>zookeeper</li><li>格式化NN</li><li>格式化ZK</li></ul></li><li>启动集群</li></ul><p>角色规划</p><table><thead><tr><th>HOST</th><th>NN</th><th>JNN</th><th>DN</th><th>ZKFC</th><th>ZK</th></tr></thead><tbody><tr><td>node01</td><td>*</td><td>*</td><td></td><td>*</td><td></td></tr><tr><td>node02</td><td>*</td><td>*</td><td>*</td><td>*</td><td>*</td></tr><tr><td>node03</td><td></td><td>*</td><td>*</td><td></td><td>*</td></tr><tr><td>node04</td><td></td><td></td><td>*</td><td></td><td>*</td></tr></tbody></table><p>Full --&gt; HA:</p><h3 id="配置" tabindex="-1"><a class="header-anchor" href="#配置" aria-hidden="true">#</a> 配置：</h3><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>core-site.xml
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://mycluster<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>ha.zookeeper.quorum<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node02:2181,node03:2181,node04:2181<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
=====================================================
hdfs-site.xml
# 一对多
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.nameservices<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mycluster<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.ha.namenodes.mycluster<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>nn1,nn2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.rpc-address.mycluster.nn1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node01:8020<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.rpc-address.mycluster.nn2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node02:8020<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.http-address.mycluster.nn1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node01:50070<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.http-address.mycluster.nn2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node02:50070<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
# 一下是JN在哪里启动，数据存储在哪里
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.shared.edits.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>qjournal://node01:8485;node02:8485;node03:8485/mycluster<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.journalnode.edits.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/var/bigdata/hadoop/ha/dfs/jn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
# 角色切换的代理类和实现方法，使用的ssh免密
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.client.failover.proxy.provider.mycluster<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.ha.fencing.methods<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>sshfence<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.ha.fencing.ssh.private-key-files<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/root/.ssh/id_rsa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
# 开启自动化，启动zkfc
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.ha.automatic-failover.enabled<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="流程" tabindex="-1"><a class="header-anchor" href="#流程" aria-hidden="true">#</a> 流程：</h3><p>——基础设施</p><p>————ssh免密：</p><p>​ 1）启动start-dfs.sh脚本的机器需要将公钥分发给别的节点</p><p>​ 2）在HA模式下，每一个NN身边会启动一个ZKFC，ZKFC会用免密的方式控制自己和其他NN节点的NN状态</p><p>——应用搭建</p><p>​ HA 依赖 ZK ，搭建的ZK集群</p><p>​ 修改hadoop的配置文件，并集群同步</p><p>——初始化启动</p><p>​ 1）先启动JN hadoop-daemon.sh start journalnode</p><p>​ 2）选择一个NN做格式化： hdfs namenode -format</p><p>​ 3）启动这个格式化的NN，以备另一台同步：hadoop-daemon.sh start namenode</p><p>​ 4）在另外一台机器中： hdfs namenode -bootstrapStandby</p><p>​ 5）格式化ZK， hdfs zkfc -formatZK</p><p>​ 6）start-dfs.sh</p><p>——使用</p><h3 id="实际操作" tabindex="-1"><a class="header-anchor" href="#实际操作" aria-hidden="true">#</a> 实际操作</h3><p>1.停止之前的集群</p><p>2.免密：node01,node02，互相免密</p><p>3.Zookeeper安装</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>node02:
	<span class="token function">tar</span> xf zook<span class="token punctuation">..</span>.tar.gz
	<span class="token function">mv</span> zoo<span class="token punctuation">..</span>	/opt/bigdata
	<span class="token builtin class-name">cd</span> /opt/bigdata/zoo<span class="token punctuation">..</span><span class="token punctuation">..</span>
	<span class="token builtin class-name">cd</span> conf
	<span class="token function">cp</span> zoo_sample.cfg zoo.cfg
	<span class="token function">vi</span> zoo.cfg
		<span class="token assign-left variable">datadir</span><span class="token operator">=</span>/var/bigdata/hadoop/zk
		server.1<span class="token operator">=</span>node02:2888:3888
		server.2<span class="token operator">=</span>node03:2888:3888
		server.3<span class="token operator">=</span>node04:2888:3888
	
	<span class="token function">mkdir</span> /var/bigdata/hadoop/zk
	<span class="token builtin class-name">echo</span> <span class="token number">1</span> <span class="token operator">&gt;</span> /var/bigdata/hadoop/zk/myid
	// 配置环境变量
	<span class="token function">vi</span> /etc/profile
		<span class="token builtin class-name">export</span> <span class="token assign-left variable">ZOOKEEPER_HOME</span><span class="token operator">=</span>/opt/bigdata/zookeeper
		<span class="token builtin class-name">export</span> <span class="token punctuation">..</span><span class="token punctuation">..</span>:<span class="token variable">$ZOOKEEPER_HOME</span>/bin
	
	// 分发Zookeeper给node03和node04
    <span class="token builtin class-name">cd</span> /opt/bigdata
    <span class="token function">scp</span> -r ./zoo<span class="token punctuation">..</span>.	node03:<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
    <span class="token function">scp</span> -r ./zoo<span class="token punctuation">..</span>.	node04:<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
node03:
	<span class="token function">mkdir</span> /var/bigdata/hadoop/zk
	<span class="token builtin class-name">echo</span> <span class="token number">2</span> <span class="token operator">&gt;</span> /var/bigdata/hadoop/zk/myid
	// 配置环境变量
	<span class="token function">vi</span> /etc/profile
		<span class="token builtin class-name">export</span> <span class="token assign-left variable">ZOOKEEPER_HOME</span><span class="token operator">=</span>/opt/bigdata/zookeeper
		<span class="token builtin class-name">export</span> <span class="token punctuation">..</span><span class="token punctuation">..</span>:<span class="token variable">$ZOOKEEPER_HOME</span>/bin
node04:
	<span class="token function">mkdir</span> /var/bigdata/hadoop/zk
	<span class="token builtin class-name">echo</span> <span class="token number">3</span> <span class="token operator">&gt;</span> /var/bigdata/hadoop/zk/myid
	// 配置环境变量
	<span class="token function">vi</span> /etc/profile
		<span class="token builtin class-name">export</span> <span class="token assign-left variable">ZOOKEEPER_HOME</span><span class="token operator">=</span>/opt/bigdata/zookeeper
		<span class="token builtin class-name">export</span> <span class="token punctuation">..</span><span class="token punctuation">..</span>:<span class="token variable">$ZOOKEEPER_HOME</span>/bin
node02-node04:
	zkServer.sh start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4）配置hadoop的core-site.xml和hdfs-site.xml</p><p>5）分发配置给其他机器</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">scp</span> core-site.xml hdfs-site.xml node02:<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
<span class="token function">scp</span> core-site.xml hdfs-site.xml node03:<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
<span class="token function">scp</span> core-site.xml hdfs-site.xml node04:<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6）验证</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>node01,node02,node03:
	hadoop-daemon.sh start journalnode
观察 /var/bigdata/hadoop/ha/dfs/jn下并没有文件
node03打开新的窗口，cd /opt/bigdata/hadoop.xx/logs,阻塞日志
tail -f hadoop-root-journalnode-node03.log 

node01:
	hdfs namenode -format ,格式化namenode（任意选择一台		namenode，不要重复格式化）
node02:
	hdfs namenode -bootstrapStandby,拉去namenode同步
	现在在/var/bigdata/hadoop/ha/dfs/name下就会有namenode的文件生成
node04：
	zkServer.sh start
	zkCli.sh，打开zookeeper的客户端
	ls ，查看目录树
	
node01:
	hdfs zkfc -formatZK，格式化zookeeper
	此操作会创建hadoop-ha/mycluster
ok,初始化完成
node01：
	start-dfs.sh
深入验证：
	1）去看jn的日志和目录变化
	2）node04
		zkCli.sh,ls /,启动后看锁
		get /hadoop-ha/mycluster/ActiveStandbyElectorLock
	3)去node01，杀死namenode，观察锁和网页两个namenode的状态
	4）恢复node01的namenode，hadoop-daemon.sh start namenode，观察锁和网页
	5）去node02，杀死zkfc，观察锁和网页

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="hdfs权限" tabindex="-1"><a class="header-anchor" href="#hdfs权限" aria-hidden="true">#</a> HDFS权限</h2><p>HDFS没有用户权限管理相关命令和接口，它使用信任客户端的方式，一般是谁启动就是谁。</p><p>有超级用户的概念：</p><p>​ linux系统中的超级用户：root</p><p>​ hdfs系统中超级用户：是namenode进程的启动用户</p><h3 id="权限管理" tabindex="-1"><a class="header-anchor" href="#权限管理" aria-hidden="true">#</a> 权限管理</h3><p>实际操作：切换我们用root搭建的HDFS ，用god这个用户来启动</p><p>node01~node04:</p><p>​ *）关闭服务</p><p>​ 1）添加用户：root</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>useradd god
passwd god
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 2）资源与用户绑定，（a、安装部署程序，b、数据存放的目录）</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>	chown	 -R 	god 	src
​	/opt/bigdata/hadoop.xxx
​	/var/bigdata/hadoop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 3）切换到god去启动 start-dfs.sh &lt; 需要免密</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>	给god做免密
​	su  god
​	ssh localhost	&gt;&gt; 为了拿到.ssh
​	node01~node02:
​			cd /home/god/.ssh
​			ssh-keygen -t rsa -P &#39;&#39; -f ./id_rsa
​	node01:
			ssh-copy-id -i id_rsa node01
			ssh-copy-id -i id_rsa node02
			ssh-copy-id -i id_rsa node03
			ssh-copy-id -i id_rsa node04
	node02:
			cd /home/god/.ssh
			ssh-copy-id -i id_rsa node01
			ssh-copy-id -i id_rsa node02		
​							
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 4）修改hdfs-site.xml，免密存放的位置修改</p><p>5）god：start-dfs.sh</p><h3 id="用户权限验证实际操作" tabindex="-1"><a class="header-anchor" href="#用户权限验证实际操作" aria-hidden="true">#</a> 用户权限验证实际操作</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>node01:
	su god
	hdfs dfs -mkdir /temp
	hdfs dfs -chown god:ooxx /temp
	hdfs dfs -chmod 770 /temp
node04:
	root:
		useradd good
		goupadd ooxx
		usermod -a -G ooxx good
	su good
		hdfs dfs -mkdir /temp/abc &lt;失败
		hdfs groups
			good:  &lt;因为hdfs已经启动不知道新添加的用户
*node01
	root:
		useradd good
		groupadd ooxx
		usermod -a -G ooxx good
	su god
		hdfs dfsadmin -refreshUserToGroupsMappings
node04:
	good:
		hdfs groups
			good : good ooxx
结论：默认hdfs依赖操作系统上的用户和组
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="hdfs-api-实际操作" tabindex="-1"><a class="header-anchor" href="#hdfs-api-实际操作" aria-hidden="true">#</a> hdfs api 实际操作</h3><p>语义：开发hdfs的client</p><p>权限：1）参考系统登录用户名；</p><p>配置环境变量，HADOOP_USER_NAME god</p><p>jdk版本：集群和开发环境版本一致</p><p>maven：构建工具</p><p>hdfs的pom：</p><p>​ hadoop：（common，hdfs，yarn，mapreduce）</p><hr><p>MapReduce：批量计算</p><p>​ 计算模型：map和reduce是一种阻塞关系</p><p>​ 实现：----&gt; 框架</p><p>​ 计算向数据移动：</p><p>​ hdfs暴露数据的位置</p><p>​ 1）资源管理</p><p>​ 2）任务调度</p><p>​ 角色：</p><p>​ JobTracker</p><p>​ 1.资源管理</p><p>​ 2.任务调度</p><p>​ TaskTracker</p><p>​ 1）任务管理</p><p>​ 2）资源汇报</p><p>​ Client</p><p>​ 1）根据每次的计算数据，咨询NN元数据（block）=》算切片：split》得到一个切片的【清单】，map的数量就有了</p><p>split是逻辑的。block是物理的，block身上有（offset，locations），split和block是有映射关系</p><p>结果：split包含偏移量，以及split对应的map任务应该移动到哪些节点（locations）split01 A 0 500 n1 n2 n3</p><p>可以支持计算向数据移动~！！！</p><p>2）生成计算程序未来运行时的相关配置文件：xxxxxxx.xml</p><p>3）未来的移动应该是相对可靠</p><p>​ Cli会讲jar，split清单，配置xml 上传到hdfs的目录中</p><p>4）cli会调用JobTracker，通知要启动一个计算程序了，并且告知文件都放在了hdfs的哪些地方</p><p>JobTracker收到启动程序之后：</p><p>​ 1）从hdfs中取回【split清单】</p><p>​ 2）根据自己收到的TT汇报的资源，最终确定每一个split对应的map应该去到哪一个节点，【确定清单】</p><p>​ 3）未来，TT再心跳的时候回取回分配给自己的任务量</p><p>TaskTracker</p><p>​ 1）在心跳取回任务后</p><pre><code>2）从hdfs中下载jar，xml。。到本机
</code></pre><p>​ 3）最终启动任务描述中的MapTask/ReduceTas，（最终，代码在某一个节点被启动，是通过，cli上传，TT下载）</p><p>问题：</p><p>​ JobTracker 3个问题：</p><p>​ 1.单点故障</p><p>​ 2.压力过大</p><p>​ 3.集成【资源管理和任务调度】，两者耦合</p><p>​ 弊端：未来新的计算框架不能复用资源管理</p><p>​ 1，重复造轮子</p><p>​ 2，因为各自实现资源管理，但是他们部署在同一批硬件上，因为隔离，所以不能感知对方的使用</p><p>so：资源争抢~~~~~~~~~</p><p>hadoop2.xx</p><p>实现：架构</p><p>​ ResourceManage 主</p><p>​ 负责整体资源的管理</p><p>​ NodeManage 从</p><p>​ 向RS汇报心跳，提交自己的资源情况</p><p>MR运行 MapReduece on yarn</p><p>1，MR-cli（切片清单、配置、jar、上传到HDFS）</p><p>2，RM选择一台不忙的节点通知NM启动一个Container，在里面反射一个MRAppMaster</p><p>3，启动MRAppMaster，从hdfs下载切片清单，向RM申请资源</p><p>4，有RM根据自己掌握的资源情况得到一个【确定清单】，通知NM来启动Container</p><p>5，Container启动后会反向注册到已经启动的MRAppMaster进程</p><p>6，MRAppMaster（曾经的JobTracker阉割版本不带资源管理） 最终将任务Task发送给Container（消息）</p><p>7，container会反射相应的Tash类对象，调用方法执行，其结果就是我们的业务逻辑代码的执行</p><p>8，计算框架都会有Task失败重试的机制</p><p>结论：</p><p>​ 问题：</p><p>​ 1，单点故障</p><p>​ yarn：每一个APP由一个自己的AppMaster调度</p><p>​ 2，压力过大</p><p>​ yarn中每一个计算程序自有AppMaster，每一个AppMaster只负责自己计算程序对的任务调度</p><p>​ 3，集成【资源管理和任务调度】，两者耦合</p><p>​ yarn只是资源管理，不负责具体的任务调度</p><p>​ 是公立的，只要计算框架继承yarn的AppMaster，大家都可以使用一个统一视图的资源层~</p><hr><h2 id="yarn搭建" tabindex="-1"><a class="header-anchor" href="#yarn搭建" aria-hidden="true">#</a> Yarn搭建</h2><p>1.最终开发MR程序</p><p>2.hadoop2.xx 出现了一个yarn：资源管理</p><p>yarn模型：container 容器，里面会运行我们的AppMaster，map/reduce Task</p><p>搭建：</p><table><thead><tr><th>node</th><th>NN</th><th>JN</th><th>ZKFC</th><th>ZK</th><th>DN</th><th>RM</th><th>NM</th></tr></thead><tbody><tr><td>node01</td><td>*</td><td>*</td><td>*</td><td></td><td></td><td></td><td></td></tr><tr><td>node02</td><td>*</td><td>*</td><td>*</td><td>*</td><td>*</td><td></td><td>*</td></tr><tr><td>node03</td><td></td><td>*</td><td></td><td>*</td><td>*</td><td>*</td><td>*</td></tr><tr><td>node04</td><td></td><td></td><td></td><td>*</td><td>*</td><td>*</td><td>*</td></tr></tbody></table><p>配置文件</p><p>mapred-site.xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.framework.name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>yarn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>yarn-site.xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.aux-services<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mapreduce_shuffle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.ha.enabled<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.zk-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node02:2181,node03:2181,node04:2181<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.cluster-id<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>zhaoxingang<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.ha.rm-ids<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>rm1,rm2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.hostname.rm1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node03<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.hostname.rm2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node04<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.webapp.address.rm1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node03:8088<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.webapp.address.rm2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node04:8088<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>流程：</p><p>hdfs所有操作在root账号下</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>node01:
	<span class="token builtin class-name">cd</span> <span class="token variable">$HADOOP_HOME</span>/etc/hadoop
	<span class="token function">cp</span> mared-site.xml.template mapred-site.xml
	<span class="token function">vi</span> mapred-site.xml
	<span class="token function">vi</span> yarn-site.xml
	<span class="token function">scp</span> mapred-site.xml yarn-site.xml node02:<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
	<span class="token function">scp</span> mapred-site.xml yarn-site.xml node03:<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
	<span class="token function">scp</span> mapred-site.xml yarn-site.xml node04:<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
	<span class="token function">vi</span> slaves // NodeManage默认会在和datanode相同点
	start-yarn.sh
node03~node04:
	yarn-daemon.sh start resourcemanager
	
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行官方提供的WC</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>hdfs dfs -mkdir -p /data/wc/input
hdfs dfs -put data.txt /data/wc/input
<span class="token builtin class-name">cd</span> <span class="token variable">$HADOOP_HOME</span>/share/hadoop/mapreduce
hadoop jar hadoop-mapreduce-examples-xxx.jar wordcount /data/wc/input 	/data/wc/output

hdfs dfs -cat /data/wc/output/part-r-r00000
hdfs dfs -get /data/wc/output/part-r-r00000 ./
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="mr提交三种方式" tabindex="-1"><a class="header-anchor" href="#mr提交三种方式" aria-hidden="true">#</a> MR提交三种方式</h2><p>1.开发 -&gt; jar -&gt; 上传到集群中的某一个节点运行</p><p>2.嵌入【linux，windows】（非hadoop jar）的集群方式 on yarn</p><p>​ client -&gt; RM -&gt;AppMaster</p><p>​ mapreduce.framework.name -&gt; yarn</p><p>​ conf.set(&quot;mapreduce.app-submission.cross-platform&quot;,&quot;true&quot;);</p><p>​ job.setJar(&quot;F:\codehome\bigdata\hdfs-api\target\hdfs-api-1.0-0.1.jar&quot;);</p><p>3.local，单机</p><p>​ mapreduce.framework.name -&gt; local</p><p>​ conf.set(&quot;mapreduce.app-submission.cross-platform&quot;,&quot;true&quot;);//win运行必须配置</p><p>支持输入</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> other <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GenericOptionsParser</span><span class="token punctuation">(</span>conf<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRemainingArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
other<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> 输入路径
other<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> 输出路径
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/note-case/assets/app.fdaa301a.js" defer></script>
  </body>
</html>
